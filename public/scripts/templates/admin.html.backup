<div class="adminTabs wide100p">
    <nav class="adminNav flex-container alignItemsCenter justifyCenter">
        <button type="button" class="manageUsersButton menu_button menu_button_icon" data-target-tab="usersList">
            <h4 data-i18n="Manager Users">Manage Users</h4>
        </button>
        <button type="button" class="newUserButton menu_button menu_button_icon" data-target-tab="registerNewUserBlock">
            <h4 data-i18n="New User">New User</h4>
        </button>
        <button type="button" class="systemLoadButton menu_button menu_button_icon" data-target-tab="systemLoadTab">
            <h4>系统负载</h4>
        </button>
        <button type="button" class="invitationCodesButton menu_button menu_button_icon" data-target-tab="invitationCodesTab">
            <h4>邀请码管理</h4>
        </button>
    </nav>
    <div class="userAccountTemplate template_element">
        <div class="flex-container userAccount alignItemsCenter flexGap10">
            <div class="flex-container flexFlowColumn alignItemsCenter flexNoGap">
                <div class="avatar" title="If a custom avatar is not set, the user's default persona image will be displayed.">
                    <img src="img/ai4.png" alt="avatar">
                </div>
                <div class="flex-container alignItemsCenter">
                    <div class="userAvatarChange right_menu_button" title="Set a custom avatar.">
                        <i class="fa-fw fa-solid fa-image"></i>
                    </div>
                    <div class="userAvatarRemove right_menu_button" title="Remove a custom avatar.">
                        <i class="fa-fw fa-solid fa-trash"></i>
                    </div>
                </div>
                <form>
                    <input type="file" class="avatarUpload" accept="image/*" hidden>
                </form>
            </div>
            <div class="flex1 flex-container flexFlowColumn flexNoGap justifyLeft">
                <div class="flex-container flexGap10 alignItemsCenter">
                    <i class="hasPassword fa-solid fa-lock" title="This account is password protected."></i>
                    <i class="noPassword fa-solid fa-lock-open" title="This account is not password protected."></i>
                    <h3 class="userName margin0"></h3>
                    <small class="userHandle">&nbsp;</small>
                </div>
                <div class="flex-container flexFlowColumn flexNoGap">
                    <span>
                        <span data-i18n="Role:">Role:</span>
                        <span class="userRole"></span>
                    </span>
                    <span>
                        <span data-i18n="Status:">Status:</span>
                        <span class="userStatus">&nbsp;</span>
                    </span>
                    <span>
                        <span data-i18n="Created:">Created:</span>
                        <span class="userCreated">&nbsp;</span>
                    </span>
                    <span class="userLoadInfo" style="display: none;">
                        <span>今日楼层:</span>
                        <span class="userTodayMessages">0</span>
                        <small class="userTotalMessages">(总计: 0楼)</small>
                    </span>
                    <span class="userLastActivity" style="display: none;">
                        <span>最后消息:</span>
                        <span class="userLastMessageTime">未知</span>
                    </span>
                </div>
            </div>
            <div class="flex-container flexFlowColumn">
                <div class="flex-container">
                    <div class="userChangeNameButton menu_button" title="Change user display name.">
                        <i class="fa-fw fa-solid fa-pencil"></i>
                    </div>
                    <div class="userEnableButton menu_button" title="Enable user account.">
                        <i class="fa-fw fa-solid fa-check"></i>
                    </div>
                    <div class="userDisableButton menu_button" title="Disable user account.">
                        <i class="fa-fw fa-solid fa-ban"></i>
                    </div>
                    <div class="userPromoteButton menu_button" title="Promote user to admin.">
                        <i class="fa-fw fa-solid fa-arrow-up"></i>
                    </div>
                    <div class="userDemoteButton menu_button" title="Demote user to regular user.">
                        <i class="fa-fw fa-solid fa-arrow-down"></i>
                    </div>
                </div>
                <div class="flex-container">
                    <div class="userBackupButton menu_button menu_button_icon" title="Download a backup of user data.">
                        <i class="fa-fw fa-solid fa-download"></i>
                    </div>
                    <div class="userChangePasswordButton menu_button" title="Change user password.">
                        <i class="fa-fw fa-solid fa-key"></i>
                    </div>
                    <div class="userDelete menu_button warning" title="Delete user account.">
                        <i class="fa-fw fa-solid fa-trash"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="navTab usersList flex-container flexFlowColumn">
    </div>
    <div class="navTab registerNewUserBlock" style="display: none;">
        <form class="flex-container flexFlowColumn flexGap10 userCreateForm" action="javascript:void(0);">
            <div class="flex-container flexNoGap">
                <span data-i18n="Display Name:">Display Name:</span>
                <span class="warning">*</span>
                <input name="_name" class="createUserDisplayName text_pole" type="text" placeholder="e.g. John Snow" autocomplete="username">
            </div>
            <div class="flex-container flexNoGap">
                <span data-i18n="User Handle:">User Handle:</span>
                <span class="warning">*</span>
                <input name="handle" class="createUserHandle text_pole" placeholder="e.g. john-snow (lowercase letters, numbers, and dashes only)" type="text" pattern="[a-z0-9-]+">
            </div>
            <div class="flex-container flexNoGap">
                <span data-i18n="Password:">Password:</span>
                <input name="password" class="createUserPassword text_pole" type="password" placeholder="[ No password ]" autocomplete="new-password">
            </div>
            <div class="flex-container flexNoGap">
                <span data-i18n="Confirm Password:">Confirm Password:</span>
                <input name="confirm" class="createUserConfirmPassword text_pole" type="password" placeholder="[ No password ]" autocomplete="new-password">
            </div>
            <span data-i18n="This will create a new subfolder...">
                This will create a new subfolder in the /data/ directory with the user's handle as the folder name.
            </span>
            <div class="flex-container justifyCenter">
                <button type="submit" class="menu_button menu_button_icon newUserRegisterFinalizeButton">
                    <i class="fa-fw fa-solid fa-user-plus"></i>
                    <span data-i18n="Create">Create</span>
                </button>
            </div>
        </form>
    </div>
    <div class="navTab systemLoadTab" style="display: none;">
        <div class="flex-container flexFlowColumn flexGap10">
            <!-- 系统负载概览 -->
            <div class="systemLoadOverview">
                <h3>系统负载概览</h3>
                <div class="flex-container flexGap10 alignItemsCenter">
                    <div class="loadMetric">
                        <label>CPU使用率:</label>
                        <div class="loadBar">
                            <div class="loadBarFill cpuLoadBar" style="width: 0%"></div>
                            <span class="loadBarText cpuLoadText">0%</span>
                        </div>
                    </div>
                    <div class="loadMetric">
                        <label>内存使用率:</label>
                        <div class="loadBar">
                            <div class="loadBarFill memoryLoadBar" style="width: 0%"></div>
                            <span class="loadBarText memoryLoadText">0%</span>
                        </div>
                    </div>
                    <div class="loadMetric">
                        <label>系统运行时间:</label>
                        <span class="systemUptimeText">0天 0时 0分 0秒</span>
                    </div>
                </div>
            </div>

            <!-- 用户负载统计 -->
            <div class="userLoadStats">
                <h3>用户负载统计</h3>
                <div class="flex-container alignItemsCenter flexGap10">
                    <button type="button" class="refreshLoadButton menu_button">
                        <i class="fa-fw fa-solid fa-refresh"></i>
                        刷新数据
                    </button>
                    <button type="button" class="clearLoadStatsButton menu_button warning">
                        <i class="fa-fw fa-solid fa-trash"></i>
                        清除统计
                    </button>
                    <div class="autoRefreshIndicator">
                        <i class="fa-fw fa-solid fa-clock"></i>
                        <span>自动刷新: 每5秒</span>
                        <div class="refreshCountdown">5</div>
                    </div>
                </div>
                                        <span class="loadStatsInfo">
                        活跃用户: <span class="activeUsersCount">0</span> |
                        总楼层: <span class="totalMessagesCount">0</span> |
                        今日楼层: <span class="todayMessagesCount">0</span>
                    </span>
                </div>
                <div class="userLoadTable">
                    <div class="userLoadTableHeader flex-container">
                        <div class="userLoadTableCell" style="flex: 1.5;">用户</div>
                        <div class="userLoadTableCell" style="flex: 1.2;">活跃度</div>
                        <div class="userLoadTableCell" style="flex: 1;">今日楼层</div>
                        <div class="userLoadTableCell" style="flex: 1.2;">历史总楼层</div>

                        <div class="userLoadTableCell" style="flex: 2;">最后消息</div>
                        <div class="userLoadTableCell" style="flex: 0.8;">操作</div>
                    </div>
                    <div class="userLoadTableBody">
                        <!-- 用户负载数据将在这里动态填充 -->
                    </div>
                </div>
            </div>

            <!-- 负载历史图表 -->
            <div class="loadHistoryChart">
                <h3>用户活跃期间系统负载历史</h3>
                <div class="chartContainer" style="height: 300px; background: #2d2d30; border: 1px solid #555; border-radius: 4px; padding: 10px;">
                    <canvas id="loadHistoryCanvas" width="800" height="280"></canvas>
                </div>
            </div>
        </div>
    </div>
    <div class="navTab invitationCodesTab" style="display: none;">
        <div class="flex-container flexFlowColumn flexGap10">
            <!-- 邀请码功能状态 -->
            <div class="invitationCodesStatus">
                <h3>邀请码功能状态</h3>
                <div class="flex-container flexGap10 alignItemsCenter">
                    <div class="statusIndicator">
                        <label>功能状态:</label>
                        <span class="invitationCodesEnabled">未知</span>
                    </div>
                </div>
            </div>

            <!-- 生成邀请码 -->
            <div class="generateInvitationCode">
                <h3>生成邀请码</h3>

                <!-- 单个生成 -->
                <div class="singleGenerate" style="margin-bottom: 20px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 10px;">单个生成</h4>
                    <div class="flex-container flexGap10 alignItemsCenter">
                        <label>过期时间（小时，留空为永不过期）:</label>
                        <input type="number" id="invitationCodeExpireHours" placeholder="24" min="1" max="8760" style="width: 100px;">
                        <button type="button" id="generateInvitationCodeBtn" class="menu_button">
                            <i class="fa-fw fa-solid fa-plus"></i>
                            生成邀请码
                        </button>
                    </div>
                </div>

                <!-- 批量生成 -->
                <div class="batchGenerate" style="margin-bottom: 20px; border-top: 1px solid #555; padding-top: 15px;">
                    <h4 style="color: #e0e0e0; margin-bottom: 10px;">批量生成</h4>
                    <div class="flex-container flexGap10 alignItemsCenter flexWrap">
                        <label>生成数量:</label>
                        <input type="number" id="batchCount" placeholder="5" min="1" max="100" value="5" style="width: 80px;">
                        <label>过期时间（小时，留空为永不过期）:</label>
                        <input type="number" id="batchExpireHours" placeholder="24" min="1" max="8760" style="width: 100px;">
                        <button type="button" id="generateBatchCodesBtn" class="menu_button">
                            <i class="fa-fw fa-solid fa-layer-group"></i>
                            批量生成
                        </button>
                    </div>
                </div>

                <!-- 生成结果显示 -->
                <div id="generatedCodeDisplay" style="display: none; margin-top: 10px; padding: 10px; background: #2d2d30; border: 1px solid #555; border-radius: 4px;">
                    <strong>新生成的邀请码:</strong>
                    <div id="generatedCodesContainer" style="margin: 10px 0;">
                        <!-- 单个邀请码显示 -->
                        <div id="singleCodeDisplay" style="display: none;">
                            <div style="font-family: monospace; font-size: 16px; color: #4CAF50; margin: 5px 0;">
                                <span id="generatedCodeText"></span>
                                <button type="button" id="copyCodeBtn" class="menu_button_icon" style="margin-left: 10px;" title="复制邀请码">
                                    <i class="fa-fw fa-solid fa-copy"></i>
                                </button>
                            </div>
                        </div>
                        <!-- 批量邀请码显示 -->
                        <div id="batchCodesDisplay" style="display: none;">
                            <div id="batchCodesList" style="max-height: 200px; overflow-y: auto; background: #1e1e1e; padding: 10px; border-radius: 4px; margin: 10px 0;">
                                <!-- 批量邀请码列表 -->
                            </div>
                            <div class="flex-container flexGap10 alignItemsCenter">
                                <button type="button" id="copyAllCodesBtn" class="menu_button">
                                    <i class="fa-fw fa-solid fa-copy"></i>
                                    复制全部
                                </button>
                                <button type="button" id="downloadCodesBtn" class="menu_button">
                                    <i class="fa-fw fa-solid fa-download"></i>
                                    下载文本文件
                                </button>
                            </div>
                        </div>
                    </div>
                    <small style="color: #888;">请立即复制并保存，关闭此面板后将无法再次查看</small>
                </div>
            </div>

            <!-- 邀请码列表 -->
            <div class="invitationCodesList">
                <h3>
                    邀请码列表
                    <button type="button" id="refreshInvitationCodesBtn" class="menu_button_icon" style="margin-left: 10px;" title="刷新列表">
                        <i class="fa-fw fa-solid fa-refresh"></i>
                    </button>
                    <button type="button" id="cleanupExpiredCodesBtn" class="menu_button_icon" style="margin-left: 5px;" title="清理过期邀请码">
                        <i class="fa-fw fa-solid fa-trash"></i>
                    </button>
                </h3>
                <div class="invitationCodesTable">
                    <div class="invitationCodesTableHeader flex-container">
                        <div class="invitationCodesTableCell" style="flex: 2;">邀请码</div>
                        <div class="invitationCodesTableCell" style="flex: 1;">创建者</div>
                        <div class="invitationCodesTableCell" style="flex: 1;">创建时间</div>
                        <div class="invitationCodesTableCell" style="flex: 1;">状态</div>
                        <div class="invitationCodesTableCell" style="flex: 1;">使用者</div>
                        <div class="invitationCodesTableCell" style="flex: 1;">过期时间</div>
                        <div class="invitationCodesTableCell" style="flex: 1;">操作</div>
                    </div>
                    <div class="invitationCodesTableBody">
                        <!-- 邀请码列表将在这里动态生成 -->
                        <div class="invitationCodesTableRow flex-container" style="justify-content: center; padding: 20px;">
                            <span style="color: #888;">加载中...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
